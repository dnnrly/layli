# layli

This tools produces diagrams and has 2 simple aims:

1. Define components and connections as code
2. Look pretty

[![GitHub release (latest SemVer)](https://img.shields.io/github/v/release/dnnrly/layli)](https://github.com/dnnrly/layli/releases/latest)
[![Build Status](https://github.com/dnnrly/layli/actions/workflows/pr.yml/badge.svg)](https://github.com/dnnrly/layli/actions/workflows/pr.yml)
[![codecov](https://codecov.io/gh/dnnrly/layli/branch/master/graph/badge.svg?token=OY6UgcQeWf)](https://codecov.io/gh/dnnrly/layli)
[![godoc](https://godoc.org/github.com/dnnrly/layli?status.svg)](http://godoc.org/github.com/dnnrly/layli)

![GitHub watchers](https://img.shields.io/github/watchers/dnnrly/layli?style=social)
![GitHub stars](https://img.shields.io/github/stars/dnnrly/layli?style=social)
[![Twitter URL](https://img.shields.io/twitter/url?style=social&url=https%3A%2F%2Fgithub.com%2Fdnnrly%2Flayli)](https://twitter.com/intent/tweet?url=https://github.com/dnnrly/layli)


[![ko-fi](https://www.ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/W7W414S4U)

## Using layli

### Installation

```
$ go install github.com/dnnrly/layli/cmd/layli
```

### A simple examples

Your first layli file:
```yml
node: "Hello World"
```

```bash
$ layli hello-world.layli
```

## layli principles

layli aims to let you specify nodes and edges (boxes and lines) and looks after arranging them in a pleasing way. If you've ever used [plantuml](https://plantuml.com) you'll be familiar with describing the diagrams in a simple to understand text file to generate a pretty diagram. Well, perhaps not as pretty as you would hope. This tool aims to solve this.

Here are some principles that hope to tackle this problem head on:

1. Edge paths must travel across a "path grid"
2. Node borders must be on the "path grid"
3. Edges must meet nodes at "ports"
4. Ports must sit on the "path grid"
5. Where a port is not specified, layli may select a "default" port on any side of the node
6. Nodes must be layed out so that the total area marked by the outside bounds of every node is as small as possible
7. Nodes must be seperated by at least 1 space on the "path grid"
8.  Edges must must not cross!
9.  Edges must follow a grid path (ie. not curved or diagonal)
10. Edges must be as short as possible
11. Edges must have as few corners as possible
12. Edge paths may sit on top of each other at the beginning or at the end



### Defining nodes

Specifying a simple node:

Complex nodes:
```yml
nodes:
  - id: node-1
    contents: "A\nwith formatting"
```

Connecting nodes:

```yml
edges:
  - from: node-1
    to: "The node name"
```

### An example diagram

Here's a layli definition:

```yaml
nodes:
  - id: node1
    contents: "Node 1"
  - id: node2
    contents: "Node 2"
  - id: node3
    contents: "Node 3"
  - id: node4
    contents: "Node 4"
  - id: node5
    contents: "Node 5"
  - id: node6
    contents: "Node 6"
  - id: node7
    contents: "Node 7"
  - id: node8
    contents: "Node 8"
  - id: node9
    contents: "Node 9"
  - id: node10
    contents: "Node 10"

edges:
  - from: node1
    to: node6
  - from: node3
    to: node6
  - from: node8
    to: node9

border: 1
margin: 1
width: 5
height: 4

```

And here's the image that is generated by this command `layli ./demo.layli --show-grid`:

<img src="/demo.svg" alt="Demonstration image" />

## Developing layli

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes. See deployment for notes on how to deploy the project on a live system.


### Running Unit Tests

```bash
$ make test
```

### Running Acceptance tests

```bash
$ make acceptance-test
```

## Important `make` targets

* `deps` - downloads all of the deps you need to build, test, and release
* `install` - installs your application
* `build` - builds your application
* `test` - runs unit tests
* `ci-test` - run tests for CI validation
* `acceptance-test` - run the acceptance tests
* `coverage-report` - merge coverage statistics from all sources
* `mocks` - generate mocks for interface
* `lint` -  run linting
* `clean` - clean project dependencies
* `clean-deps` - remove all of the build dependencies too


## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md) for details on our code of conduct, and the process for submitting pull requests to us.

## Versioning

We use [SemVer](http://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/dnnrly/layli/tags). 

## Authors

* **Pascal Dennerly** - *Initial work* - [dnnrly](https://github.com/dnnrly)

See also the list of [contributors](https://github.com/dnnrly/layli/contributors) who participated in this project.

## License

This project is licensed under the Apache 2.0 License - see the [LICENSE](LICENSE) file for details

## Acknowledgments

* There is a blog that I read a couple of years ago that described solving a similar problem. For the life of me, I can't remember find it anywhere to give the appropriate credit. But believe me when I say that a lot of the ideas are based on this blog and a lot of credit belongs to the author.
